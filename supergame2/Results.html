{{ extends "global/Page.html" }}
{{ block title }}Round {{ player.round_number }} results{{ endblock }}

{{ block content }}
<style>
  /* Expand to full width */
  .otree-body {
    max-width: 95% !important;
    width: 95% !important;
    padding: 0 !important;
  }

  /* Set base font size globally */
  body {
    font-size: 1.2rem !important;  /* ~19px */
    line-height: 1.6;
  }

  /* Flex layout for panels */
  .wrapper {
    display: flex;
    width: 100%;
    height: 100vh;
  }

  .split {
    flex: 1;
    overflow-y: auto;
    padding: 30px;
    box-sizing: border-box;
  }

  .left {
    background-color: #f8f9fa;
    border-right: 1px solid #ccc;
  }

  .right {
    background-color: #e9ecef;
  }

  /* Tables */
  table {
    width: 100%;
    font-size: 1.1rem;
    border-collapse: collapse;
  }

  th, td {
    padding: 10px;
    text-align: center;
    border:1px solid black;
    border-radius: 10px;
  }

  /* Buttons and form elements */
  .otree-btn-next, .btn, input, textarea {
    font-size: 1.1rem;
  }

  h1, h2, h3 {
    font-size: 1.5rem;
  }
  .chat-wrapper {
    height: 700px;
    border: 1px solid #ccc;
    display: flex;
    flex-direction: column;
  }

  .otree-chat {
    flex: 1;
    display: flex;
    flex-direction: column;
    height: 100% !important;
  }

  .otree-chat__messages {
    flex: 1;
    overflow-y: auto;
  }
</style>
<div class="wrapper">
  <div class="split left">
    <h2 style="font-size:24px;">Results</h2>
    <p style="font-size:24px;">
      You placed {{ pcont }} tokens in the group account, therefore your private account balance is <span style = "color:red;">{{ priv }}</span> tokens.
      Your group members allocated the following to the group account:<br><br>
      <b>{{ one }}: {{ one_cont }} tokens<br>
      {{ two }}: {{ two_cont }} tokens<br>
      {{ three }}: {{ three_cont }} tokens</b><br><br>
      <b>Your group's total account balance is <span style="color:blue;">{{ gcont }}</span> tokens.</b><br>
      <b>Your profit is therefore <span style="color:red;">{{ priv }}</span> + &frac14; x 1.6 x <span style = "color:blue;">{{ gcont }}</span> = {{ pay }} ECUs.</b>
    </p><br><br>
    <h2 style="font-size:24px;">Table of Previous Results</h2>
     <table border="1" style="font-size:24px;">
       <tr>
         <th>Round</th>
         {% for label in player_labels %}
           <th>Player {{ label }}</th>
         {% endfor %}
         <th>Your Payoff</th>
       </tr>
       {% for row in table_data %}
         <tr>
           <td>{{ row.round }}</td>
           {% for c in row.contributions %}
             <td>{{ c }} tokens</td>
           {% endfor %}
           <td>{{ row.your_payoff }} tokens</td>
         </tr>
       {% endfor %}
     </table>
  </div>

  <div class="split right">
    <h2 style="font-size:24px;">Chat</h2>
    <p style="font-size:24px;">Use this page to chat with your group members. Remember to hit the send button after typing a chat.</p>
    <div class="chat-wrapper">
      {{ chat nickname=player.participant.label }}
    </div>
  </div>
</div>
{{ endblock }}
